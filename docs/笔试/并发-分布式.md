# 并发及分布式相关问题
1. 单点问题： 分布式系统中某个节点出现问题导致整个系统无法正常运行。

2. 什么是分布式事务，分布式事务产生的原因是什么？分布式事务的解决方案有哪些？分别有哪些优缺点？   
    分布式事务：将一个大的操作分为多个小的操作，并在不同服务器上执行，分布式事务要保证这些小的事务要么同时成功，要么同时失败。
    分布式事务本质上是为了解决不同数据库之间的数据一致性问题。  
    分布式事务产生原因：1.数据库分库分表：当数据量过多时，我们要考虑对数据库进行分库分表，这样一个数据库就变成了多个数据库
    当一个请求要涉及到多个数据库时，我们为了保持数据库之间的数据一致性，就要采用分布式事务  
    2.应用SOA化(面向服务的架构)
    
    解决方案:   
     1.两阶段提交(2PC)  
     2.补偿事务(TCC)    
     3.[本地消息表(异步确保)]()    
     4.MQ事务消息  
     
### 分布式包括的常见问题
事务，缓存，ID,队列，限流，存储，计算，锁

### 分布式Id  
要求:  
1. 全局唯一性:在集群中保持数据id的唯一性，这是基本要求。
2. 递增性:要求id对用户或是业务是递增的。
3. 高可用性:确保在任何时候都能生成可用的Id
4. 高性能性:在高并发情况下，依旧能生成正确id

解决方案:
1. UUID:java自带的生成随机36位的唯一字符串（32位字符+4位'-'），可以保证唯一性，但是可读性差。
2. SnowFlake(雪花算法):Twitter开源的64位整数组成的分布式Id,性能较高，且能做到单机自增。  
    简介：64位id被分为4部分：1bit占用位、41bit时间戳、10bit工作机器id、12bit序列号  
    ![雪花算法id](../../picture/分布式/雪花算法.PNG)  
    1. 占用位:其值总是为0，无实际意义。
    2. 时间戳:精确到毫秒，这样可以保证id在时间层面上的递增。
    3. 工作机器id:10bit可以使集群容纳1024个节点同时并行进行数据存储。
    4. 序列号:12bit可以允许每个节点每毫秒产生4096个全局唯一id  
    
由此可以得知每毫秒可以生产1024*4096个全局唯一id。[雪花算法]()具体实现